(self.webpackChunkairview_next=self.webpackChunkairview_next||[]).push([[9872],{"./stories/Editor.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{APIError:()=>APIError,Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>Editor_stories});var esm_extends=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/extends.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),inherits=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/inherits.js"),possibleConstructorReturn=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),getPrototypeOf=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),taggedTemplateLiteral=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),gurx_react=__webpack_require__("./node_modules/@mdxeditor/editor/dist/gurx/react.js"),realmFactory=__webpack_require__("./node_modules/@mdxeditor/editor/dist/gurx/realmFactory.js"),dist_MDXEditor=(__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/codeblock/CodeBlockNode.js"),__webpack_require__("./node_modules/@mdxeditor/editor/dist/MDXEditor.js")),diff_source=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/diff-source/index.js"),codeblock=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/codeblock/index.js"),CodeMirrorEditor=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/codemirror/CodeMirrorEditor.js"),headings=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/headings/index.js"),frontmatter=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/frontmatter/index.js"),lists=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/lists/index.js"),plugins_link=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/link/index.js"),plugins_image=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/image/index.js"),link_dialog=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/link-dialog/index.js"),quote=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/quote/index.js"),table=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/table/index.js"),thematic_break=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/thematic-break/index.js"),markdown_shortcut=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/markdown-shortcut/index.js"),toolbar=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/index.js"),components_UndoRedo=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/UndoRedo.js"),components_BlockTypeSelect=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/BlockTypeSelect.js"),components_BoldItalicUnderlineToggles=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/BoldItalicUnderlineToggles.js"),components_CreateLink=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/CreateLink.js"),components_InsertTable=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/InsertTable.js"),InsertImage=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/InsertImage.js"),components_InsertCodeBlock=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/InsertCodeBlock.js"),components_InsertThematicBreak=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/InsertThematicBreak.js"),components_InsertFrontmatter=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/InsertFrontmatter.js"),components_DiffSourceToggleWrapper=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/DiffSourceToggleWrapper.js"),Lexical=__webpack_require__("./node_modules/lexical/Lexical.js"),Paper=(__webpack_require__("./node_modules/gray-matter/index.js"),__webpack_require__("./node_modules/@mui/material/Paper/Paper.js")),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),Container=__webpack_require__("./node_modules/@mui/material/Container/Container.js"),Box=__webpack_require__("./node_modules/@mui/material/Box/Box.js"),__jsx=react.createElement;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function AsideAndMainContainer(_ref){var children=_ref.children;return __jsx(Container.Z,{maxWidth:!1,sx:{paddingTop:0,paddingBottom:6}},__jsx(Box.Z,{sx:{display:"flex"}},children))}function Main(_ref2){var children=_ref2.children,sx=_ref2.sx;return __jsx(Box.Z,{component:"main",sx:_objectSpread({flex:"1 1 auto"},sx)},children)}function Aside(_ref3){var children=_ref3.children,sx=_ref3.sx;return __jsx(Box.Z,{component:"aside",sx:_objectSpread({flex:"0 0 auto",width:300,paddingLeft:4,displayPrint:"none"},sx)},children)}AsideAndMainContainer.displayName="AsideAndMainContainer",AsideAndMainContainer.propTypes={children:prop_types_default().node},Main.displayName="Main",Main.propTypes={children:prop_types_default().node},Aside.displayName="Aside",Aside.propTypes={children:prop_types_default().node},AsideAndMainContainer.__docgenInfo={description:"",methods:[],displayName:"AsideAndMainContainer",props:{children:{description:"",type:{name:"node"},required:!1}}},Main.__docgenInfo={description:"",methods:[],displayName:"Main",props:{children:{description:"",type:{name:"node"},required:!1}}},Aside.__docgenInfo={description:"",methods:[],displayName:"Aside",props:{children:{description:"",type:{name:"node"},required:!1}}};var path=__webpack_require__("./node_modules/path/path.js"),path_default=__webpack_require__.n(path),baseTheme=__webpack_require__("./constants/baseTheme.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),CircularProgress=__webpack_require__("./node_modules/@mui/material/CircularProgress/CircularProgress.js"),Snackbar=__webpack_require__("./node_modules/@mui/material/Snackbar/Snackbar.js"),Button=__webpack_require__("./node_modules/@mui/material/Button/Button.js"),redux_toolkit_esm=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),branchSlice=__webpack_require__("./lib/redux/reducers/branchSlice.js");const store=(0,redux_toolkit_esm.xC)({reducer:{branch:branchSlice.Z}});var _templateObject,_templateObject2,Fab_Fab=__webpack_require__("./node_modules/@mui/material/Fab/Fab.js"),Alert=__webpack_require__("./node_modules/@mui/material/Alert/Alert.js"),Grid=__webpack_require__("./node_modules/@mui/material/Grid/Grid.js"),TextField=__webpack_require__("./node_modules/@mui/material/TextField/TextField.js"),Save=__webpack_require__("./node_modules/@mui/icons-material/Save.js"),styled=__webpack_require__("./node_modules/@mui/material/styles/styled.js"),console=__webpack_require__("./node_modules/console-browserify/index.js"),Editor_jsx=react.createElement;function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=(0,getPrototypeOf.Z)(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,getPrototypeOf.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,possibleConstructorReturn.Z)(this,result)}}function Editor_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}var EditorStateContext=(0,react.createContext)(),toKebabCase=function toKebabCase(str){return str.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},convertStyleObjectToCSS=function convertStyleObjectToCSS(styleObject){for(var indent=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",cssString="",_i=0,_Object$entries=Object.entries(styleObject);_i<_Object$entries.length;_i++){var _Object$entries$_i=(0,slicedToArray.Z)(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];"object"==typeof value?(cssString+="".concat(indent).concat(toKebabCase(key)," {\n"),cssString+=convertStyleObjectToCSS(value,indent+"  "),cssString+="".concat(indent,"}\n")):cssString+="".concat(indent).concat(toKebabCase(key),": ").concat(value,";\n")}return cssString};function convertMdastToLexical(mdastNode){switch(mdastNode.type){case"mdxJsxTextElement":return function convertJsxElement(jsxNode){var tagName=jsxNode.name,attributes=jsxNode.attributes.map((function(attr){return"".concat(attr.name,'="').concat(attr.value,'"')})).join(" "),children=jsxNode.children.map(convertMdastToLexical).join("");return"<".concat(tagName," ").concat(attributes,">").concat(children,"</").concat(tagName,">")}(mdastNode);case"text":return mdastNode.value;default:return""}}var catchAllVisitor={testNode:function testNode(){return!0},visitNode:function visitNode(_ref){var mdastNode=_ref.mdastNode,actions=_ref.actions,lexicalParent=_ref.lexicalParent,paragraph=(0,Lexical.$createParagraphNode)();console.debug("Editor:catchAllPlugin:mdastNode: ",mdastNode),console.debug("Editor:catchAllPlugin:actions: ",actions),console.debug("Editor:catchAllPlugin:lexicalParent: ",lexicalParent);try{var lexicalContent=convertMdastToLexical(mdastNode);console.log("Editor:catchAllPluging:lexicalContent: ",lexicalContent),paragraph.append((0,Lexical.$createTextNode)(lexicalContent))}catch(err){console.debug("Editor:catchAllPlugin:mdastNode: ",mdastNode),console.error("Editor:catchAllPlugin:error: ",err)}console.log("Editor:catchAllPluging:paragraph: ",paragraph),lexicalParent.append(paragraph),console.log("Editor:catchAllPluging:lexicalParent: ",lexicalParent)}},_realmPlugin=(0,gurx_react.nq)({id:"catchAll",systemSpec:(0,realmFactory.By)((function(){return{}})),init:function init(realm){realm.pubKey("addImportVisitor",catchAllVisitor)}});(0,slicedToArray.Z)(_realmPlugin,1)[0];function Editor(_ref2){var initialMarkdown=_ref2.markdown,context=_ref2.context,callbackSave=_ref2.callbackSave,_ref2$enabled=_ref2.enabled,enabled=void 0===_ref2$enabled||_ref2$enabled,top=_ref2.top,_useState=(0,react.useState)(initialMarkdown),_useState2=(_useState[0],_useState[1],(0,react.useState)(!1)),_useState3=(_useState2[0],_useState2[1],(0,react.useState)(!1)),isLoading=_useState3[0],setIsLoading=_useState3[1],_useState4=(0,react.useState)(null),error=_useState4[0],setError=_useState4[1],_useState5=(0,react.useState)(null),success=_useState5[0],setSuccess=_useState5[1],ref=(0,react.useRef)(),collection=(null==context?void 0:context.path)||"null",reduxCollection=store.getState().branch[collection];console.log("Editor:context: ",context),console.log("Editor:reduxCollection: ",reduxCollection),console.log("Editor:initialMarkdown: ",initialMarkdown.substring(0,100));var typographyCopy=function Editor_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Editor_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Editor_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},baseTheme.w.typography);delete typographyCopy.table;var importedCss=convertStyleObjectToCSS(typographyCopy),StyledMDXEditor=(0,styled.ZP)(dist_MDXEditor.P)(_templateObject||(_templateObject=(0,taggedTemplateLiteral.Z)(['\n    font-family: "Heebo";\n    font-weight: 200;\n    font-size: 14;\n    [role="toolbar"] {\n      // border: 1px solid #d1d5db;\n      // border-radius: 0.15rem;\n      // border-bottom-right-radius: 0;\n      // border-bottom-left-radius: 0;\n    }\n    [class*="_contentEditable_"] {\n      height: calc(100vh - ','px);\n      overflow-y: auto;\n      overflow-x: hidden;\n    }\n    [role="textbox"] {\n      // background-color: white;\n      // border: 1px solid #d1d5db;\n      // border-top: none;\n      // border-radius: 0.15rem;\n      // border-top-right-radius: 0;\n      // border-top-left-radius: 0;\n    }\n    [class^="_rootContentEditableWrapper"] {\n      /* Your CSS styles for elements with the matching class name here */\n      h1,\n      h2,\n      h3,\n      h4,\n      h5,\n      h6 {\n        font-weight: 200;\n        line-height: 1.2l;\n      }\n      h1 {\n        font-size: "3rem";\n      }\n      h2 {\n        font-size: "2rem";\n      }\n      h3 {\n        font-size: "1rem";\n      }\n      ',"\n      .cm-gutters {\n        margin-right: 1%;\n        margin-left: 1%;\n      }\n      .cm-scroller {\n        display: flex;\n      }\n    }\n    img {\n      max-width: 50%;\n      height: auto;\n    }\n  "])),top,(0,styled_components_browser_esm.iv)(_templateObject2||(_templateObject2=(0,taggedTemplateLiteral.Z)(["\n        ","\n      "])),importedCss)),editorCallback=(0,react.useCallback)((function(callback){}),[initialMarkdown,enabled]),editorPlugins=(0,react.useMemo)((function(){return[(0,diff_source.oy)({diffMarkdown:initialMarkdown,viewMode:"rich-text"}),(0,codeblock.u9)({codeBlockEditorDescriptors:[{priority:100,match:function match(){return!0},Editor:CodeMirrorEditor.s}]}),(0,headings.bB)(),(0,frontmatter.Gp)(),(0,lists.df)(),(0,plugins_link.a)(),(0,plugins_image.Fi)(),(0,link_dialog.w)(),(0,quote.q)(),(0,table.zf)(),(0,thematic_break.nz)(),(0,markdown_shortcut.O)(),(0,plugins_image.Fi)({disableImageResize:!0,imageUploadHandler:function imageUploadHandler(image){return Promise.resolve(function _imageUploadHandler(_x2){return _imageUploadHandler2.apply(this,arguments)}(image))},imagePreviewHandler:function imagePreviewHandler(imageSource){return Promise.resolve(function _imagePreviewHandler(_x){return _imagePreviewHandler2.apply(this,arguments)}(imageSource))}}),(0,toolbar.N2)({toolbarContents:function toolbarContents(){return Editor_jsx(react.Fragment,null," ",Editor_jsx(components_UndoRedo.Q,null),Editor_jsx(components_BlockTypeSelect.I,null),Editor_jsx(components_BoldItalicUnderlineToggles.$,null),Editor_jsx(components_CreateLink.c,null),Editor_jsx(components_InsertTable.c,null),Editor_jsx(InsertImage.a,null),Editor_jsx(components_InsertCodeBlock.j,null),Editor_jsx(components_InsertThematicBreak.c,null),Editor_jsx(components_InsertFrontmatter.t,null),Editor_jsx(components_DiffSourceToggleWrapper.V,null))}})]}),[initialMarkdown]);function _imagePreviewHandler2(){return(_imagePreviewHandler2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(imageSource){var file,filePath,response,blob,imageObjectUrl;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(console.log("Editor:imagePreviewHandler: ",context,imageSource),!imageSource.startsWith("http")){_context2.next=3;break}return _context2.abrupt("return",imageSource);case 3:return file=path_default().dirname(context.file)+"/"+imageSource.replace(/^\/|^\.\//,""),filePath=file.replace(/^\/|^\.\//,""),console.log("Editor:imagePreviewHandler:filePath: ",filePath),_context2.next=8,fetch("/api/content/github/".concat(context.owner,"/").concat(context.repo,"?branch=").concat(context.branch,"&path=").concat(filePath));case 8:if(response=_context2.sent,console.log("Editor:imagePreviewHandler:response: ",response),response.ok){_context2.next=12;break}throw new Error("Editor:imagePreviewHandler:HTTP error! status: ".concat(response.status));case 12:return _context2.next=14,response.blob();case 14:return blob=_context2.sent,imageObjectUrl=URL.createObjectURL(blob),console.log("Editor:imagePreviewHandler:imageObjectUrl: ",imageObjectUrl),_context2.abrupt("return",imageObjectUrl);case 18:case"end":return _context2.stop()}}),_callee2)})))).apply(this,arguments)}function _imageUploadHandler2(){return(_imageUploadHandler2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee4(image){var file,fileName;return regenerator_default().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return console.log("Editor:imageUploadHandler: ",context,image),(new FormData).append("image",image),file=path_default().dirname(context.file)+"/"+image.name.replace(/[^a-zA-Z0-9.]/g,"").toLowerCase(),fileName=image.name.replace(/[^a-zA-Z0-9.]/g,"").toLowerCase(),_context4.abrupt("return",new Promise((function(resolve,reject){var reader=new FileReader;reader.onloadend=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee3(){var base64Image,imageData,url;return regenerator_default().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return base64Image=reader.result,imageData=base64Image.split(",")[1],console.log("Editor:imageUploadHandler:base64Image: ",base64Image),_context3.prev=3,_context3.next=6,createFile(context.owner,context.repo,context.branch,file,fileName,imageData,"Image uploaded from Airview");case 6:(url=_context3.sent)?resolve(url):reject("Error uploading image"),_context3.next=13;break;case 10:_context3.prev=10,_context3.t0=_context3.catch(3),reject(_context3.t0);case 13:case"end":return _context3.stop()}}),_callee3,null,[[3,10]])}))),reader.onerror=reject,reader.readAsDataURL(image)})));case 6:case"end":return _context4.stop()}}),_callee4)})))).apply(this,arguments)}return Editor_jsx(EditorStateContext.Provider,{value:{editorCallback,ref,reduxCollection,context,callbackSave}},Editor_jsx(Paper.Z,{sx:{px:"1%"},elevation:0},Editor_jsx(EditorErrorBoundary,{markdown:initialMarkdown,callbackSave,initialMarkdown,ref},Editor_jsx(StyledMDXEditor,{ref,onChange:editorCallback,onError:function onError(msg){return console.warn("Error in markdown: ",msg)},markdown:initialMarkdown,plugins:editorPlugins}),Editor_jsx(Fab_Fab.Z,{color:"primary","aria-label":"save",disabled:!enabled||isLoading,style:{position:"fixed",bottom:16,right:16},onClick:(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var _ref$current,text;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setIsLoading(!0),setError(null),_context.prev=2,text=null===(_ref$current=ref.current)||void 0===_ref$current?void 0:_ref$current.getMarkdown(),_context.next=6,callbackSave(text);case 6:setSuccess("Saved successfully"),_context.next=12;break;case 9:_context.prev=9,_context.t0=_context.catch(2),setError(_context.t0.message);case 12:return _context.prev=12,setIsLoading(!1),_context.finish(12);case 15:case"end":return _context.stop()}}),_callee,null,[[2,9,12,15]])})))},isLoading?Editor_jsx(CircularProgress.Z,{size:24}):Editor_jsx(Save.Z,null)),Editor_jsx(Snackbar.Z,{open:!!error,autoHideDuration:5e3,onClose:function onClose(){return setError(null)}},Editor_jsx(Alert.Z,{onClose:function onClose(){return setError(null)},severity:"error",sx:{width:"100%"}},error)),Editor_jsx(Snackbar.Z,{open:!!success,autoHideDuration:5e3,onClose:function onClose(){return setSuccess(null)}},Editor_jsx(Alert.Z,{onClose:function onClose(){return setSuccess(null)},severity:"info",sx:{width:"100%"}},success)))))}function SaveButton(){var _React$useContext=react.useContext(EditorStateContext),ref=_React$useContext.ref,callbackSave=(_React$useContext.reduxCollection,_React$useContext.context,_React$useContext.callbackSave);return Editor_jsx(Button.Z,{variant:"outlined",size:"medium",startIcon:Editor_jsx(Save.Z,null),onClick:function onClick(){var _ref$current2,text=null===(_ref$current2=ref.current)||void 0===_ref$current2?void 0:_ref$current2.getMarkdown();callbackSave(text)}},"Save")}function createFile(_x3,_x4,_x5,_x6,_x7,_x8,_x9){return _createFile.apply(this,arguments)}function _createFile(){return(_createFile=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee5(owner,repo,branch,file,fileName,content,message){var filePath,response,data;return regenerator_default().wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return console.debug("Editor:createFile: ",owner,repo,branch,file,fileName,content,message),filePath=file.replace(/^\/|^\.\//,""),_context5.prev=2,_context5.next=5,fetch("/api/content/github/".concat(owner,"/").concat(repo,"?branch=").concat(branch,"&path=").concat(filePath),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content,message})});case 5:if((response=_context5.sent).ok){_context5.next=8;break}throw new Error("HTTP error! status: ".concat(response.status));case 8:return _context5.next=10,response.json();case 10:return data=_context5.sent,console.log("Editor:createFile:Commit successful:",data),_context5.abrupt("return",fileName);case 15:return _context5.prev=15,_context5.t0=_context5.catch(2),console.error("Editor:createFile:Error committing file:",_context5.t0.message),_context5.abrupt("return",null);case 19:case"end":return _context5.stop()}}),_callee5,null,[[2,15]])})))).apply(this,arguments)}Editor.displayName="Editor",SaveButton.displayName="SaveButton";var EditorErrorBoundary=function(_React$Component){(0,inherits.Z)(EditorErrorBoundary,_React$Component);var _super=_createSuper(EditorErrorBoundary);function EditorErrorBoundary(props){var _this;return(0,classCallCheck.Z)(this,EditorErrorBoundary),(_this=_super.call(this,props)).state={hasError:!1},_this}return(0,createClass.Z)(EditorErrorBoundary,[{key:"componentDidCatch",value:function componentDidCatch(error,errorInfo){}},{key:"render",value:function render(){return console.log("EditorErrorBoundary:RENDER:Error:",this.state.hasError),this.state.hasError?Editor_jsx(FallbackEditor,{markdown:this.props.markdown,callbackSave:this.props.callbackSave,initialMarkdown:this.props.initialMarkdown,ref:this.props.ref}):this.props.children}}],[{key:"getDerivedStateFromError",value:function getDerivedStateFromError(error){return{hasError:!0}}}]),EditorErrorBoundary}(react.Component);function FallbackEditor(_ref6){var initialMarkdown=_ref6.markdown,callbackSave=_ref6.callbackSave,_useState6=(0,react.useState)(initialMarkdown),markdown=_useState6[0],setMarkdown=_useState6[1],handleSave=function handleSave(){console.log("Content saved"),callbackSave(markdown)};return Editor_jsx(Grid.ZP,{container:!0,direction:"column",style:{height:"calc(100vh - 50px)"}},Editor_jsx(Grid.ZP,{item:!0},Editor_jsx(Alert.Z,{severity:"warning"},"Using the fallback editor")),Editor_jsx(Grid.ZP,{item:!0,style:{flex:1,overflow:"auto"}},Editor_jsx(TextField.Z,{id:"outlined-multiline-static",multiline:!0,fullWidth:!0,variant:"outlined",onChange:function onChange(event){return setMarkdown(event.target.value)},defaultValue:markdown,sx:{mt:"1%","& .MuiInputBase-input":{},"& .MuiInputBase-root":{minHeight:"calc(100vh - 250px)",alignItems:"baseline"}}})),Editor_jsx(Fab_Fab.Z,{color:"primary","aria-label":"save",style:{position:"fixed",bottom:16,right:16},onClick:handleSave},Editor_jsx(Save.Z,null)))}EditorErrorBoundary.displayName="EditorErrorBoundary",FallbackEditor.displayName="FallbackEditor",Editor.__docgenInfo={description:"",methods:[],displayName:"Editor",props:{enabled:{defaultValue:{value:"true",computed:!1},required:!1}}};var Editor_stories_jsx=react.createElement;const Editor_stories={title:"Content/Editor",component:Editor};var dummyContext={source:"github",repo:"airwalk_patterns",owner:"airwalk-digital",base_branch:"main",branch:"main",path:"providers",reference:"provider",collections:["services"]},Template=function Template(args){var _useState=(0,react.useState)(""),mdxContent=_useState[0],setMdxContent=_useState[1];function _dummyFunction(){return(_dummyFunction=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var delay;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return delay=function delay(ms){return new Promise((function(resolve){return setTimeout(resolve,ms)}))},_context.next=3,delay(2e3);case 3:_context.t0=args.result,_context.next="success"===_context.t0?6:"error"===_context.t0?7:8;break;case 6:return _context.abrupt("break",8);case 7:throw new Error("An error occurred");case 8:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}return(0,react.useEffect)((function(){var styleLink=document.createElement("link");styleLink.rel="stylesheet",styleLink.href="https://unpkg.com/@mdxeditor/editor@1.14.3/dist/style.css",document.head.appendChild(styleLink),fetch("/ExampleMDX.mdx").then((function(response){return response.text()})).then((function(text){return setMdxContent(text)}))}),[]),Editor_stories_jsx(Editor,(0,esm_extends.Z)({},args,{markdown:mdxContent,callbackSave:function dummyFunction(){return _dummyFunction.apply(this,arguments)}}))};Template.displayName="Template";var Default=Template.bind({});Default.args={context:dummyContext,enabled:!0,top:0,result:"success"};var APIError=Template.bind({});APIError.args={context:dummyContext,enabled:!0,top:0,result:"error"},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'args => {\n  const [mdxContent, setMdxContent] = useState("");\n  async function dummyFunction() {\n    const delay = ms => new Promise(resolve => setTimeout(resolve, ms));\n    await delay(2000);\n    switch (args.result) {\n      case \'success\':\n        break;\n      case \'error\':\n        throw new Error(\'An error occurred\');\n    }\n  }\n  useEffect(() => {\n    const styleLink = document.createElement("link");\n    styleLink.rel = "stylesheet";\n    styleLink.href = "https://unpkg.com/@mdxeditor/editor@1.14.3/dist/style.css";\n    document.head.appendChild(styleLink);\n    fetch("/ExampleMDX.mdx").then(response => response.text()).then(text => setMdxContent(text));\n  }, []);\n  return <Editor {...args} markdown={mdxContent} callbackSave={dummyFunction} />;\n}',...Default.parameters?.docs?.source}}},APIError.parameters={...APIError.parameters,docs:{...APIError.parameters?.docs,source:{originalSource:'args => {\n  const [mdxContent, setMdxContent] = useState("");\n  async function dummyFunction() {\n    const delay = ms => new Promise(resolve => setTimeout(resolve, ms));\n    await delay(2000);\n    switch (args.result) {\n      case \'success\':\n        break;\n      case \'error\':\n        throw new Error(\'An error occurred\');\n    }\n  }\n  useEffect(() => {\n    const styleLink = document.createElement("link");\n    styleLink.rel = "stylesheet";\n    styleLink.href = "https://unpkg.com/@mdxeditor/editor@1.14.3/dist/style.css";\n    document.head.appendChild(styleLink);\n    fetch("/ExampleMDX.mdx").then(response => response.text()).then(text => setMdxContent(text));\n  }, []);\n  return <Editor {...args} markdown={mdxContent} callbackSave={dummyFunction} />;\n}',...APIError.parameters?.docs?.source}}};const __namedExportsOrder=["Default","APIError"]},"./lib/redux/reducers/branchSlice.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__,t:()=>setBranch});var _home_runner_work_airview_next_airview_next_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),_site_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./site.config.js");function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,_home_runner_work_airview_next_airview_next_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_0__.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var branchSlice=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.oM)({name:"branch",initialState:_site_config__WEBPACK_IMPORTED_MODULE_1__.J.content,reducers:{setBranch:function setBranch(state,action){return _objectSpread(_objectSpread({},state),{},(0,_home_runner_work_airview_next_airview_next_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_0__.Z)({},action.payload.path,action.payload))}}}),setBranch=branchSlice.actions.setBranch;const __WEBPACK_DEFAULT_EXPORT__=branchSlice.reducer},"./site.config.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{J:()=>siteConfig});var siteConfig={title:"Airview",company:"airwalkreply.com",tagline:"technology, done right",etherpad:{url:"https://pad.airview.airwalkconsulting.io"},content:{services:{source:"github",repo:"airwalk_patterns",owner:"airwalk-digital",branch:"main",path:"services",reference:"service",collections:["knowledge","designs"],menu:{component:"FullHeaderMenu",collection:"providers"}},providers:{source:"github",repo:"airwalk_patterns",owner:"airwalk-digital",branch:"main",path:"providers",reference:"provider",collections:["services"]},solutions:{source:"github",repo:"airwalk_patterns",owner:"airwalk-digital",branch:"main",path:"solutions",reference:"solution",collections:["knowledge","designs"],menu:{component:"ListMenu",collection:"solutions"}},knowledge:{source:"github",repo:"airwalk_patterns",owner:"airwalk-digital",branch:"main",path:"knowledge",reference:"knowledge",menu:{component:"DummyMenu",collection:null}},designs:{source:"github",repo:"airwalk_patterns",owner:"airwalk-digital",branch:"main",path:"designs",reference:"design",collections:["knowledge"]},customers:{source:"github",repo:"airwalk_patterns",owner:"airwalk-digital",branch:"main",path:"customers",reference:"customer",collections:["knowledge","projects"]},projects:{source:"github",repo:"airwalk_patterns",owner:"airwalk-digital",branch:"main",path:"projects",reference:"project",collections:["knowledge"],menu:{component:"FullHeaderMenu",collection:"customers"}},products:{source:"github",repo:"airwalk_patterns",owner:"airwalk-digital",branch:"main",path:"products",reference:"product",collections:["knowledge","designs"]}}}},"?8f81":()=>{}}]);